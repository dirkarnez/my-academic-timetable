<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css"
    >
    <style>
        :root {
            --bulma-body-overflow-y: visible;
            --bulma-body-overflow-x: visible;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">Title</h1>
        <div class="columns is-multiline">
            <div class="column is-full has-background-light">
                <div class="columns  is-multiline">
                    <div class="column is-full">Monday</div>
                    <div class="column is-full">Third column</div>
                    <div class="column is-full">Fourth column</div>
                </div>
            </div>

            <div class="column is-full has-background-dark">
                <div class="columns  is-multiline">
                    <div class="column is-full">Tuesday</div>
                    <div class="column is-full ">Third column</div>
                    <div class="column is-full">Fourth column</div>
                </div>
            </div>

            
            <div class="column is-full has-background-dark">
                <div class="columns  is-multiline">
                    <div class="column is-full">Tuesday</div>
                    <div class="column is-full ">Third column</div>
                    <div class="column is-full">Fourth column</div>
                </div>
            </div>

            
            <div class="column is-full has-background-dark">
                <div class="columns  is-multiline">
                    <div class="column is-full">Tuesday</div>
                    <div class="column is-full ">Third column</div>
                    <div class="column is-full">Fourth column</div>
                </div>
            </div>

            
            <div class="column is-full has-background-dark">
                <div class="columns  is-multiline">
                    <div class="column is-full">Tuesday</div>
                    <div class="column is-full ">Third column</div>
                    <div class="column is-full">Fourth column</div>
                </div>
            </div>
        </div>
    </div>
    <script>
        const timeTable = document.getElementById("timetable");

        const addLesson = (weekDay, startHours, startMinutes, endHours, endMinutes) => {
            const epochStart = new Date(Date.UTC(0));
            epochStart.setHours(startHours);
            epochStart.setMinutes(startMinutes);

            const epochEnd = new Date(Date.UTC(0));
            epochEnd.setHours(endHours);
            epochEnd.setMinutes(endMinutes);

            const durationInHours = (epochEnd - epochStart) / 60 / 60 / 1000;

            const rowsNeeded = durationInHours / 0.5;

        };

        function removeDuplicates(array, uniqueIdFunction) {
            if (!Array.isArray(array)) {
                return [];
            }
            // Create a Set to store unique IDs
            const uniqueIds = new Set();
            
            // Filter the array to remove duplicates
            return array.filter(obj => {
                // If the ID is not in the Set, add it and keep the object
                const key = uniqueIdFunction(obj);
                if (!uniqueIds.has(key)) {
                    uniqueIds.add(key);
                    return true;
                }
                // Otherwise, discard the object
                return false;
            })
        }

        const data = `
        [
            {"subject_code":"AMA2104","weekday":"Mon","start_time":"12:30","end_time":"14:20","venue":"R902"},
            {"subject_code":"AMA2104","weekday":"Wed","start_time":"15:30","end_time":"16:20","venue":"U208"},
            {"subject_code":"AMA2104","weekday":"Mon","start_time":"12:30","end_time":"14:20","venue":"R902"},
            {"subject_code":"AMA2104","weekday":"Wed","start_time":"15:30","end_time":"16:20","venue":"U208"}
        ]
        `;

        const removeSameCourse = array => removeDuplicates(array, a => `${a["start_time"]}-${a["end_time"]}`)

        const parse = time => {
            const hM = time.split(":");
            const epochTime = new Date(Date.UTC(0));
            epochTime.setHours(hM[0]);
            epochTime.setMinutes(hM[1]);
            return epochTime;
        }

        function compareStartTime(a, b) {
            return a["start_time"] - b["start_time"];
        }

        function preprocess(a) {
            return ({
                ...a,
                "start_time": parse(a["start_time"]),
                "end_time": parse(a["end_time"])
            })
        }

        const result = Object.groupBy(JSON.parse(data), ({ weekday }) => weekday);

        const mon = removeSameCourse(result["Mon"])
            .map(a => preprocess(a))
            .sort(function(a, b) {
                console.log("!!!!!")
                return a["start_time"] - b["start_time"];
            });


        // .forEach(course => {
        //     // addLesson(1, course["start_time"].getHour(), course["start_time"].getMinutes(), course["end_time"].getHour(), course["end_time"].getMinutes());
        // })
        // removeSameCourse(result["Tue"]).sort(compareStartTime)
        // removeSameCourse(result["Wed"]).sort(compareStartTime)
        // removeSameCourse(result["Thu"]).sort(compareStartTime)
        // removeSameCourse(result["Fri"]).sort(compareStartTime)
        // removeSameCourse(result["Sat"]).sort(compareStartTime)
        debugger;
        




        
        

    </script>
</body>
</html>